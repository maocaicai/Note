## 使用场景

在Java编程中，出现只知接口而不知实现，该怎么办？

就像现在的Client，它知道要使用Api接口，但是不知由谁实现，也不知道如何实现，从而得不到接口对象，就无法使用接口，该怎么办呢？

## 定义

![img](https://upload-images.jianshu.io/upload_images/2062729-1949fb647308eb28.png?imageMogr2/auto-orient/strip|imageView2/2/w/836/format/webp)

## 解决思路

虽然不能让模块外部知道模块内的具体实现，但是**模块内部是可以知道实现类的，而且创建接口是需要具体实现类的**。

那么干脆在模块内部新建一个类，**在这个类里面来创建接口，然后把创建好的接口返回给客户端，这样外部应用就只需要根据这个类来获取相应的接口对象，然后就可以操作接口定义的方法了**。把这样的对象称为简单工厂，就叫Factory吧。

这样一来，客户端就可以通过这个Factory来获取需要的接口对象，然后调用接口的方法来实现需要的功能，而且客户端也不用再关心具体实现了。

## 简单工厂示例代码##

1. **先看看Api的定义，示例代码如下：**

```csharp
/**
   * 接口的定义，该接口可以通过简单工厂来创建
   */  
public interface Api {  
     /**
      * 示意，具体的功能方法的定义
      * @param s 示意，需要的参数
      */  
     public void operation(String s);  
}  
```

1. **定义了接口，该来实现它了，ImplA的示例代码如下：**



```csharp
/**
   * 接口的具体实现对象A
   */  
public class ImplA implements Api{  
     public void operation(String s) {  
         //实现功能的代码，示意一下  
         System.out.println("ImplA s=="+s);  
     }  
}  

/**
   * 接口的具体实现对象B
   */  
public class ImplB implements Api{  
     public void operation(String s) {  
         // 实现功能的代码，示意一下  
         System.out.println("ImplB s=="+s);  
     }  
}  
```

1. **该来看看简单工厂的实现，示例代码如下：**

```csharp
/**
   * 工厂类，用来创造Api对象
   */  
public class Factory {  
     /**
      * 具体的创造Api对象的方法
      * @param condition 示意，从外部传入的选择条件
      * @return 创造好的Api对象
      */  
     public static Api createApi(int condition){  
         //应该根据某些条件去选择究竟创建哪一个具体的实现对象，  
         //这些条件可以从外部传入，也可以从其它途径获取。  
         //如果只有一个实现，可以省略条件，因为没有选择的必要。  

         //示意使用条件  
         Api api = null;  
         if(condition == 1) {  
             api = new ImplA();  
         } else if(condition == 2) {  
             api = new ImplB();  
         }  
         return api;  
     }  
}  
```

1. **再来看看客户端的示意，示例代码如下：**



```cpp
/**
   * 客户端，使用Api接口
   */  
public class Client {  
     public static void main(String[] args) {  
         //通过简单工厂来获取接口对象  
         Api api = Factory.createApi(1);  
         api.operation("正在使用简单工厂");  
     }  
}  
```

## 简单工厂的优缺点##

> **帮助封装：**简单工厂虽然很简单，但是非常友好的帮助我们实现了组件的封装，**然后让组件外部能真正面向接口编程**。

> **解耦：通过简单工厂，实现了客户端和具体实现类的解耦**。如同上面的例子，客户端根本就不知道具体是由谁来实现，也不知道具体是如何实现的，客户端只是通过工厂获取它需要的接口对象。

> **可能增加客户端的复杂度：**如果通过客户端的参数来选择具体的实现类，那么就必须让客户端能理解各个参数所代表的具体功能和含义，这会增加客户端使用的难度，也部分暴露了内部实现，这种情况可以选用可配置的方式来实现。

> **不方便扩展子工厂：**私有化简单工厂的构造方法，使用静态方法来创建接口，也就不能通过写简单工厂类的子类来改变创建接口的方法的行为了。不过，通常情况下是不需要为简单工厂创建子类的。

## 思考简单工厂##

1. **简单工厂的本质**

**简单工厂的本质是：选择实现。**

**注意简单工厂的重点在选择，实现是已经做好了的。**就算实现再简单，也要由具体的实现类来实现，而不是在简单工厂里面来实现。**简单工厂的目的在于为客户端来选择相应的实现，从而使得客户端和实现之间解耦**，这样一来，具体实现发生了变化，就不用变动客户端了，这个变化会被简单工厂吸收和屏蔽掉。

**实现简单工厂的难点就在于“如何选择”实现**，前面讲到了几种传递参数的方法，那都是静态的参数，还可以实现成为动态的参数。比如：在运行期间，由工厂去读取某个内存的值，或者是去读取数据库中的值，然后根据这个值来选择具体的实现等等。

1. **何时选用简单工厂**

建议在如下情况中，选用简单工厂：

> **如果想要完全封装隔离具体实现，让外部只能通过接口来操作封装体**，那么可以选用简单工厂，让客户端通过工厂来获取相应的接口，而无需关心具体实现；
>
> **如果想要把对外创建对象的职责集中管理和控制**，可以选用简单工厂，一个简单工厂可以创建很多的、不相关的对象，可以把对外创建对象的职责集中到一个简单工厂来，从而实现集中管理和控制。